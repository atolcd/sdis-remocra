<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="utf-8">
    <title>Remocra - dev</title>
  </head>
    <div id="app"></div>
    <!-- built files will be auto injected -->
    <style>
      body {
        padding: 10px;
      }
      .home {
        text-decoration: none;
        z-index: 99999999;
        position: fixed;
        right: 5px;
        top: 0;
      }
      .help.start {
        opacity: 0.6;
        font-style: italic;
      }
      .Fiche {
        max-width: 900px;
        max-height: 679px;
      }
    </style>

    <a class="home" href="/">‚Øá</a>

    <div id="crise-container"></div>
    <div id="fichepei-container"></div>
    <div id="autre" style="display: none;">
      <h1>Remocra - D√©veloppements</h1>
      <div class="help start">
        Suivre les √©tapes suivantes :
        <ol>
          <li>D√©marrer le client Vue.js <code>npm run serve</code></li>
          <li>D√©marrer son serveur Tomcat <code>mvn tomcat:run</code></li>
          <li>S'authentifier <a href="http://localhost:8080/remocra" target="_blank">http://localhost:8080/remocra</a></li>
          <li>Utiliser un des liens suivants</li>
        </ol>
      </div>
      <div class="help links">
        <b>üíß Exemples PEI :</b>
        <ul>
          <li>Cr√©ation de
            <a href="?module=hydrant&code=PIBI&geometrie=POINT%20(651812%206862842)">PIBI</a>, de
            <a href="?module=hydrant&code=PENA&geometrie=POINT%20(651812%206862842)">PENA</a>
          </li>
          <li>Ouverture fiche de
            <a href="?module=hydrant&id=226678&code=PIBI&geometrie=POINT%20(651812%206862842)">PIBI</a>, de
            <a href="?module=hydrant&id=267796&code=PENA">PENA</a>
          </li>
          <li>Nouvelle visite de
            <a href="?module=hydrant&id=226678&code=PIBI&geometrie=POINT%20(651812%206862842)&newVisite=true">PIBI</a>, de
            <a href="?module=hydrant&id=267796&code=PENA&newVisite=true">PENA</a>
          </li>
        </ul>
        <b>‚ùó Exemples Crise :</b>
        <ul>
          <li><a href="?module=crise&id=1">Ouverture d'une crise</a></li>
        </ul>
      </div>
    </div>
  </body>
    <script type="text/javascript">
      var s = window.location.href.split('?');
      if (s.length==2) {
        var rawUrl = s[1];
        var params = _.chain(rawUrl).replace('?', '').split('&').map(_.partial(_.split, _, '=', 2)).fromPairs().value();
        if (params['module']=='crise' && params['id']) {
          // Crise
          remocraVue.criseBuildMap('container', params['id']);

        } else if (params['module']=='hydrant' && params['id'] && params['code']) {
          // PEI Mise √† jour
          remocraVue.peiBuildFiche('#fichepei-container', {
            newVisite: params['newVisite']?params['newVisite']=='true':null,
            id: Number(params['id']), code: params['code'],
            geometrie: params['geometrie']?decodeURIComponent(params['geometrie']):null, title:'PEI - Mise √† jour'
          });
        } else if (params['module']=='hydrant' && params['geometrie'] && params['code']) {
          // PEI Cr√©ation
          remocraVue.peiBuildFiche('#fichepei-container', {
            id: null, code: params['code'], geometrie: params['geometrie']?decodeURIComponent(params['geometrie']):null, title:'PEI - Cr√©ation'
          });
        } else¬†{
          document.getElementById('autre').style.display=''
        }
      } else {
        document.getElementById('autre').style.display=''
      }
    </script>
</html>
